<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Computational approach &mdash; MTE 1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=f2a433a1"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Benchmarks" href="benchmarks.html" />
    <link rel="prev" title="Governing equations" href="governing_equations.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >

          
          
          <a href="index.html">
            
              <img src="_static/Logo2r2.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
   
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="governing_equations.html">Governing equations</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Computational approach</a></li>
<li class="toctree-l1"><a class="reference internal" href="benchmarks.html">Benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameters.html">Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="flanksim.html">Synthetic topopography: flank simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="artdem.html">Artificial DEM</a></li>
<li class="toctree-l1"><a class="reference internal" href="etna.html">Case study: Mount Etna</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="ref.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="app1.html">Complete derivation of the equations</a></li>
</ul>

   <ul>
        <li class="toctree-l1"><a href= "genindex.html"><strong>Index</strong></a></li>
   </ul>


        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MTE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Computational approach</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="computational-approach">
<h1>Computational approach<a class="headerlink" href="#computational-approach" title="Link to this heading"></a></h1>
<div class="line-block">
<div class="line">From the <a class="reference internal" href="governing_equations.html#ge"><span class="std std-ref">previous section</span></a>, we know the generated magnetic field <span class="math notranslate nohighlight">\(\mathbf{B_a}\)</span> of an object with volume <span class="math notranslate nohighlight">\(V\)</span> can be defined as the surface integral of each volume element <span class="math notranslate nohighlight">\(\mathit{dv'}\)</span> holding a dipole moment equal to <span class="math notranslate nohighlight">\(\mathbf{M} \mathit{dv'}\)</span>. What follows is the general outline and the step wise procedure of the Finite Element Model (FEM) presented in this study that solves this integral equation. As terminology can be confusing when comparing (field) data to (model) data, we will use the following terms and nouns to refer to each:</div>
<div class="line">‘<em>measurement points</em>’ = the points and location at which in the field was ‘<em>measured</em>’.</div>
<div class="line">‘<em>observation points</em>’ = the points and location at which the model ‘<em>computed</em>’ the values, can be equal to measurement points.</div>
</div>
<div class="line-block">
<div class="line">First, a 3D domain <span class="math notranslate nohighlight">\(\Omega\)</span> , containing an uniform magnetization, is tessellated into multiple elements, where the amount of elements in each direction define the resolution. This produces a mesh, composed of hexahedron elements defined by eight nodes and 6 surfaces, with nodes numbered in a clockwise fashion. Each element now represents a volume of uniform magnetization.</div>
</div>
<div class="line-block">
<div class="line">Next, as our main objective is to investigate the effect of the underlying topography, we simulate the domain’s topography of the domain three different ways:</div>
</div>
<blockquote>
<div><ul class="simple">
<li><p>An (approximation by) equation (in this study: flank simulations of wavy topography on a volcano)</p></li>
<li><p>Obtaining elevation data from a DEM (in this study: a 2x2m and 5x5m DEM)</p></li>
</ul>
</div></blockquote>
<div class="line-block">
<div class="line">The first method allows for model output validation (see <a class="reference internal" href="benchmarks.html"><span class="doc">Benchmarks</span></a>), parameter determination for further testing and flank simulations. The other method serves to compare computed results to field data. Once the 2D surface topography is generated, the 3D domain is placed below and elements are reshaped if necessary. In the second method the resolution of the domain is limited by the resolution of the DEM used. The base of the model’s domain mirrors the surface’s topography, or alternatively, it is a level plane established at a predetermined depth below the synthetic topography’s lowest elevation.</div>
<div class="line"><br /></div>
<div class="line">Next, the magnetic anomaly at observation point <code class="docutils literal notranslate"><span class="pre">P</span></code> produced by an element is computed using the surface integral (second part of eq. <a class="reference internal" href="governing_equations.html#equation-bsumfinal">(5)</a>) with the method proposed by <span id="id1">[<a class="reference internal" href="ref.html#id16" title="Richard J. Blakely. Potential Theory in Gravity and Magnetic Applications. Cambridge University Press, 1995. doi:10.1017/CBO9780511549816.006.">Blakely, 1995</a>]</span>. A Python function <a class="reference internal" href="functions.html#magnetostatics.facmag" title="magnetostatics.facmag"><code class="xref py py-func docutils literal notranslate"><span class="pre">magnetostatics.facmag()</span></code></a>, mirroring their original Fortran 77 subroutine, calculates the magnetic anomaly of an arbitrary polyhedron when iteratively applied to all its faces. The approach, grounded largely in <span id="id2">[<a class="reference internal" href="ref.html#id26" title="M. H. P. Bott. Two methods applicable to computers for evaluating magnetic anomalies due to finite three dimensional bodies. Geophysical Prospecting, 11(3):292-299, 1963. URL: https://www.earthdoc.org/content/journals/10.1111/j.1365-2478.1963.tb02039.x, doi:https://doi.org/10.1111/j.1365-2478.1963.tb02039.x.">Bott, 1963</a>]</span>’s work, resolves the surface integral by projecting onto triangles connecting the facet intersection with a perpendicular line through <code class="docutils literal notranslate"><span class="pre">P</span></code> (illustrated in <span id="id3">[<a class="reference internal" href="ref.html#id16" title="Richard J. Blakely. Potential Theory in Gravity and Magnetic Applications. Cambridge University Press, 1995. doi:10.1017/CBO9780511549816.006.">Blakely, 1995</a>]</span>), weighting triangles by their proximity to <code class="docutils literal notranslate"><span class="pre">P</span></code>.</div>
<div class="line">A spatial problem, where <code class="docutils literal notranslate"><span class="pre">P</span></code> lies on the facet plane, is mitigated by introducing a small (<span class="math notranslate nohighlight">\(\epsilon=1e^{-20}\)</span>)  as the ‘distance’ from the face for computations <span id="id4">[<a class="reference internal" href="ref.html#id16" title="Richard J. Blakely. Potential Theory in Gravity and Magnetic Applications. Cambridge University Press, 1995. doi:10.1017/CBO9780511549816.006.">Blakely, 1995</a>]</span>.</div>
<div class="line">Ultimately, the function’s repeated calls for every side of all elements sums the magnetic contribution across the 3D domain to calculate (<span class="math notranslate nohighlight">\(\mathbf{B_a (r)}\)</span>) in <code class="docutils literal notranslate"><span class="pre">P</span></code>, see <a class="reference internal" href="governing_equations.html#figmodel"><span class="std std-numref">Figure 1</span></a>, see fuction <a class="reference internal" href="functions.html#magnetostatics.compute_B_surface_integral_cuboid" title="magnetostatics.compute_B_surface_integral_cuboid"><code class="xref py py-func docutils literal notranslate"><span class="pre">magnetostatics.compute_B_surface_integral_cuboid()</span></code></a>.</div>
<div class="line">After generating topography on both (or either) the top and bottom surfaces, nodes of these elements might not reside in one plane. So, each element’s top and bottom surface is subdivided into four additional triangles, for a total of 12 faces and 10 nodes defining an element, see function <a class="reference internal" href="functions.html#magnetostatics.compute_B_surface_integral_wtopo" title="magnetostatics.compute_B_surface_integral_wtopo"><code class="xref py py-func docutils literal notranslate"><span class="pre">magnetostatics.compute_B_surface_integral_wtopo()</span></code></a>.</div>
<div class="line">This introduces more singularities leading to spatial problems similar to before, if a observation point <code class="docutils literal notranslate"><span class="pre">P</span></code> is located on a diagonal of the additional triangles on the top (or bottom) face of the hexahedron elements. A function, <a class="reference internal" href="functions.html#support.shift_observation_points_edge" title="support.shift_observation_points_edge"><code class="xref py py-func docutils literal notranslate"><span class="pre">support.shift_observation_points_edge()</span></code></a>, was designed to shift the x-coordinate of any observation points near the diagonals of any elements with a small distance (<span class="math notranslate nohighlight">\(\epsilon=1e^{-5}\)</span>).</div>
</div>
<div class="line-block">
<div class="line">Once the ambient field produced by the underlying lava flow is obtained, the induction of the Earth’s magnetic field at <code class="docutils literal notranslate"><span class="pre">P</span></code> can be added. Finally, the intensity (<span class="math notranslate nohighlight">\(\mathbf{B}\)</span>), inclination (<span class="math notranslate nohighlight">\(I\)</span>) and declination (<span class="math notranslate nohighlight">\(D\)</span>) of the (total) magnetic field above the flow were calculated from the magnetic field components <span id="id5">[<a class="reference internal" href="ref.html#id20" title="Lisa Tauxe. Essentials of paleomagnetism. Univ of California Press, 2010.">Tauxe, 2010</a>]</span>, see function <a class="reference internal" href="functions.html#support.add_referencefield" title="support.add_referencefield"><code class="xref py py-func docutils literal notranslate"><span class="pre">support.add_referencefield()</span></code></a>.</div>
</div>
<div class="line-block">
<div class="line">Rooted in defining an element as a single dipole (eq. <a class="reference internal" href="governing_equations.html#equation-sd">(3)</a>), this method assumes that volume elements are ‘small enough’ and the distance to <code class="docutils literal notranslate"><span class="pre">P</span></code> is ‘large’ <span id="id6">[<a class="reference internal" href="ref.html#id17" title="David J Griffiths. Introduction to electrodynamics; 4th ed. Pearson, Boston, MA, 2013. Re-published by Cambridge University Press in 2017. URL: https://cds.cern.ch/record/1492149, doi:1108420419.">Griffiths, 2013</a>]</span>, with its applicability, particularly for mesh elements closest to <code class="docutils literal notranslate"><span class="pre">P</span></code>, hinging on a constant magnetization assumption, which theoretically renders the elemental size irrelevant <span id="id7">[<a class="reference internal" href="ref.html#id16" title="Richard J. Blakely. Potential Theory in Gravity and Magnetic Applications. Cambridge University Press, 1995. doi:10.1017/CBO9780511549816.006.">Blakely, 1995</a>]</span>. Furthermore, <span id="id8">[<a class="reference internal" href="ref.html#id18" title="John David Jackson. Classical electrodynamics. Wiley, New York, NY, 3rd ed. edition, 1999. ISBN 9780471309321. URL: http://cdsweb.cern.ch/record/490457.">Jackson, 1999</a>]</span> determines distance-related concerns are negligible unless <code class="docutils literal notranslate"><span class="pre">P</span></code> lies within a few molecular diameters of a uniformly magnetized element. Hereby rendering the assumption a valid one, in line with comparable studies <span id="id9">[<a class="reference internal" href="ref.html#id23" title="C. Baag, C. E. Helsley, Shi-zhe Xu, and B. R. Lienert. Deflection of paleomagnetic directions due to magnetization of the underlying terrain. Journal of Geophysical Research: Solid Earth, 100(B6):10013-10027, 1995. URL: https://agupubs.onlinelibrary.wiley.com/doi/abs/10.1029/95JB00148, arXiv:https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/95JB00148, doi:10.1029/95JB00148.">Baag <em>et al.</em>, 1995</a>]</span>.</div>
</div>
<div class="line-block">
<div class="line">It is important to mention that <code class="docutils literal notranslate"><span class="pre">MTE.py</span></code> contains sections of code <a class="footnote-reference brackets" href="#id11" id="id10" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> that implement a volume integral computation method, a fully functional segment of the code. This approach solves <a class="reference internal" href="governing_equations.html#equation-sd">(3)</a> after inserting <a class="reference internal" href="governing_equations.html#equation-magnetization">(2)</a> by using a Gaussian quadrature method. The results using this method were similar to those computed using the surface integral method when testing the <a class="reference internal" href="benchmarks.html"><span class="doc">Benchmarks</span></a>. Nevertheless, the substantial computational demands of resolving a volume integral, when compared to a surface integral, resulted in the discontinuation of this method for reproducing the field sites.</div>
</div>
<p class="rubric">Footnotes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id11" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id10">1</a><span class="fn-bracket">]</span></span>
<p>There are also lines of code to include the volume integral values when exporting the computed values for visualization and plotting for the relevant sections. Activate by setting <code class="docutils literal notranslate"><span class="pre">compute_vi</span> <span class="pre">=</span> <span class="pre">True</span></code>, does not compute for DEM tests.</p>
</aside>
</aside>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="governing_equations.html" class="btn btn-neutral float-left" title="Governing equations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="benchmarks.html" class="btn btn-neutral float-right" title="Benchmarks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, A.E. Hendrickx.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
<style type="text/css">
  .scrollToTop {
    text-align: center;
    font-weight: bold;
    position: fixed;
    bottom: 60px;
    right: 40px;
    display: none;
  }
</style>
<a href="#" class="scrollToTop">Scroll To Top</a>
<script type="text/javascript">
  $(document).ready(function () {
    //Check to see if the window is top if not then display button
    $(window).scroll(function () {
      if ($(this).scrollTop() > 200) {
        $(".scrollToTop").fadeIn();
      } else {
        $(".scrollToTop").fadeOut();
      }
    });

    //Click event to scroll to top
    $(".scrollToTop").click(function () {
      $("html, body").animate(
        {
          scrollTop: 0,
        },
        500,
      );
      return false;
    });
  });
</script>

<style>
  /* Sidebar header (and topbar for mobile) */
  .wy-side-nav-search,
  .wy-nav-top {
    background: #3ae23a;
  }
  /* Sidebar */
  .wy-nav-side {
    background: #0c3303;
  }
</style>


</body>
</html>