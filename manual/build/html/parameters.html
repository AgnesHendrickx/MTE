<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Parameters &mdash; MTE 1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=f2a433a1"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Synthetic topopography: flank simulations" href="flanksim.html" />
    <link rel="prev" title="Benchmarks" href="benchmarks.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >

          
          
          <a href="index.html">
            
              <img src="_static/Logo2r2.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
   
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="governing_equations.html">Governing equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="computational_approach.html">Computational approach</a></li>
<li class="toctree-l1"><a class="reference internal" href="benchmarks.html">Benchmarks</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Parameters</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#resolution">Resolution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#model-setup">Model setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#results">Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reproduce">Reproduce </a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#size">Size</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id8">Model setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#results-and-analysis">Results and analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id9">Reproduce</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#verification">Verification</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id10">Reproduce</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#challenges-in-setup-optimization">Challenges in Setup Optimization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id12">Reproduce</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#bottom-boundary">Bottom boundary</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id13">Model setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id14">Results</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id15">Reproduce</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#conclusions">Conclusions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="flanksim.html">Synthetic topopography: flank simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="artdem.html">Artificial DEM</a></li>
<li class="toctree-l1"><a class="reference internal" href="etna.html">Case study: Mount Etna</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="ref.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="app1.html">Complete derivation of the equations</a></li>
</ul>

   <ul>
        <li class="toctree-l1"><a href= "genindex.html"><strong>Index</strong></a></li>
   </ul>


        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MTE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Parameters</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="parameters">
<span id="id1"></span><h1>Parameters<a class="headerlink" href="#parameters" title="Link to this heading"></a></h1>
<div class="line-block">
<div class="line">Replicating shapes in a discretized domain comes with inherent limitations that can potentially lead to inaccuracies in the computed values.</div>
<div class="line">Following <a class="reference internal" href="benchmarks.html#benchmarks"><span class="std std-ref">benchmarking</span></a>, the next key step in the model validation process of any geodynamic model is to investigate the effect of model setup parameters and initial (boundary) conditions on the final results.</div>
<div class="line">For precise and optimal anomaly computations over varied topographies, it is crucial to identify the minimum quantity of elements necessary for a accurate representation of volcanic terrain, and determining the minimal domain size to mitigate the impact of the edge effect.</div>
<div class="line">This edge effect, which occurs at the boundaries of the simulated domain, emerges from the cutoff at the outer boundary of the domain, generating its own unique magnetic anomaly. Our goal is to minimize the edge effect while also managing the absolute dimensions and resolution of the domain to ensure computational efficiency and reduce the time and effort required. Furthermore, the effect of the topography of the bottom boundary of the domain will be investigated.</div>
</div>
<div class="line-block">
<div class="line">These parameters were determined using a domain with synthetic topography, the southern flank setup as outlined in the section <a class="reference internal" href="flanksim.html#flanksim"><span class="std std-ref">flank simulations</span></a>. Furthermore, the test were repeated for a zero topography setup (<a class="reference internal" href="benchmarks.html#b2"><span class="std std-ref">benchmark 2a</span></a> ). The experiments were conducted along a path elevated 1 meter above the ground, representing the minimum elevation level for most field sites with observation points approximately 1 meter apart. Since the lowest elevation necessitates the largest resolutions and domain size, this setup will establish the threshold.</div>
</div>
<div class="line-block">
<div class="line">It remains unclear whether the parameters defined through these tests can be directly correlated with the thresholds needed for calculations over topographies derived from a DEM. The real topographical variations on any volcano are anticipated to encompass larger and more intricate structures. Larger structures could potentially induce greater anomalies, which might extend farther, given that the magnitude of a magnetic anomaly generated by an entity is directly proportional to its physical properties (volume or weight) and is moderated by the distance, as noted in <span id="id2">[<a class="reference internal" href="ref.html#id17" title="David J Griffiths. Introduction to electrodynamics; 4th ed. Pearson, Boston, MA, 2013. Re-published by Cambridge University Press in 2017. URL: https://cds.cern.ch/record/1492149, doi:1108420419.">Griffiths, 2013</a>]</span>. Consequently, a reevaluation of these parameters will be essential in upcoming DEM examinations.</div>
</div>
<div class="line-block">
<div class="line">Please note that the illustrations displayed here showcase only a fraction of the numerous tests executed to ascertain the necessary parameters and highlight significant discoveries. Furthermore, while these tests were specifically conducted for our case study on Mount Etna, most results are generally applicable. However, we still suggest exercising caution and recommend conducting repeated tests for future studies to ensure validity and accuracy in different contexts.</div>
</div>
<section id="resolution">
<h2>Resolution<a class="headerlink" href="#resolution" title="Link to this heading"></a></h2>
<div class="line-block">
<div class="line">The resolution experiments will initiate at a high resolution, gradually reducing the number of elements. We anticipate identifying a threshold where any further reduction would lead to incorrect values. Understanding the manifestation of these errors is instrumental in identifying them in other intricate setups, particularly when using the Digital Elevation Model (DEM).</div>
</div>
<section id="model-setup">
<h3>Model setup<a class="headerlink" href="#model-setup" title="Link to this heading"></a></h3>
<div class="line-block">
<div class="line">All these tests maintained a consistent domain size of <span class="math notranslate nohighlight">\(50\times50\times120m\)</span> for the synthetic topography setup. The expanded depth range was selected to minimize the interference from the bottom surface. To analyze this effect, some tests were conducted with a doubled domain depth of 240 meters, marked as “DD” configurations.</div>
<div class="line">Variations in the number of elements were explored in both the x and y directions, fluctuating within a range of 10 to 75 elements.</div>
</div>
<div class="line-block">
<div class="line">It is expected that adjusting the number of elements in the depth dimension would not impact the outcome. As, theoretically, all internal forces should negate each other, meaning that increasing this quantity would only extend the computation time.</div>
<div class="line">The tests were repeated for the setup of a zero topography, however, the effect of resolution variations are expected to be redundant, as subdividing a flat surface into multiple surfaces yields no benefit, but rather will only increase computation time.</div>
<div class="line">Nonetheless, these hypotheses were examined through experiments.</div>
</div>
</section>
<section id="results">
<h3>Results<a class="headerlink" href="#results" title="Link to this heading"></a></h3>
<figure class="align-default" id="id17">
<span id="restestcomp"></span><a class="reference internal image-reference" href="_images/restest_comp.png"><img alt="_images/restest_comp.png" src="_images/restest_comp.png" style="width: 1120.0px; height: 420.0px;" /></a>
<figcaption>
<p><span class="caption-number">Figure 9 </span><span class="caption-text">Three subplots depicting the components of the computed magnetic field <strong>B</strong> for the resolution experiments. The initial domain size is <span class="math notranslate nohighlight">\(50\times50\times120m\)</span>, <code class="docutils literal notranslate"><span class="pre">DD</span></code> relates to extended domain depth to 240 meter, the numbers in the key relate to the amount of elements in each direction. Please note, the y-axis varies between each subplot.</span><a class="headerlink" href="#id17" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id18">
<span id="restestzt"></span><a class="reference internal image-reference" href="_images/restest_zt_all.png"><img alt="_images/restest_zt_all.png" src="_images/restest_zt_all.png" style="width: 1120.0px; height: 420.0px;" /></a>
<figcaption>
<p><span class="caption-number">Figure 10 </span><span class="caption-text">Three subplots depicting the components of the computed magnetic field <strong>B</strong> for the resolution experiments. The initial domain size is <span class="math notranslate nohighlight">\(250\times250\times20m\)</span>, the numbers in the key relate to the amount of elements in each direction.</span><a class="headerlink" href="#id18" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="line-block">
<div class="line"><a class="reference internal" href="#restestcomp"><span class="std std-numref">Figure 9</span></a> presents the findings of the resolution tests for the synthetic topography. As predicted by theory, the amount of elements in the z-direction does not affect the outcomes. For all subsequent tests, <strong>the amount of elements in the z-direction will be maintained at 10</strong>.</div>
<div class="line">In the xy-directions, allocating half an element per meter proves to be marginally adequate, with only minor deviations noted for the synthetic topography results. When the resolution is reduced further, a distinctive pattern emerges; the computed values first exhibit instability at the highest slope, indicated by abrupt fluctuations in what was previously a smooth progression. Future tests will aim to maintain a standard of <strong>1.5 elements per meter in the spatial direction</strong>, wherever feasible, while staying observant of these distinctive errors.</div>
<div class="line">Furthermore, <a class="reference internal" href="#restestcomp"><span class="std std-numref">Figure 9</span></a> indicates that the depth extent of the domain does not alter the observed trends stemming from insufficient resolution, but instead generates a shift in the magnetic field strength.</div>
<div class="line">It should be noted that a curved surface is particularly hard to accurately represent with hexahedron elements, hence, another arbitrary shape might require much less resolution to produce adequate results.</div>
</div>
</section>
<section id="reproduce">
<h3>Reproduce <a class="footnote-reference brackets" href="#id16" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a><a class="headerlink" href="#reproduce" title="Link to this heading"></a></h3>
<details class="summary-how-to-reproduce-the-results-and-figures-for-zero-topography">
<summary>How to reproduce the results and figures for zero topography</summary><p>Please note basic setup in <a class="reference internal" href="usage.html#installation"><span class="std std-ref">Installation</span></a>.</p>
<ol class="arabic">
<li><p>In <code class="docutils literal notranslate"><span class="pre">MTE.py</span></code>, modify benchmark attribution to <code class="docutils literal notranslate"><span class="pre">2a</span></code>:</p>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="linenos">45</span><span class="n">benchmark</span> <span class="o">=</span> <span class="s1">&#39;2a&#39;</span>
</span></pre></div>
</div>
</div>
</li>
<li><p>Run first setup &amp; move files</p>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">106</span><span class="k">if</span> <span class="n">benchmark</span> <span class="o">==</span> <span class="s1">&#39;2a&#39;</span><span class="p">:</span>
<span class="linenos">107</span>   <span class="c1"># General settings</span>
<span class="linenos">108</span>   <span class="n">remove_zerotopo</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos">109</span>   <span class="n">compute_analytical</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos">110</span>   <span class="n">do_spiral_measurements</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos">111</span>   <span class="n">do_path_measurements</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos">112</span>
<span class="linenos">113</span>   <span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">114</span>   <span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">20</span>
</span><span class="hll"><span class="linenos">115</span>   <span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">10</span>
</span><span class="hll"><span class="linenos">116</span>   <span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>  <span class="c1"># Magnetization [A/m].</span>
</span><span class="linenos">117</span>
<span class="linenos">118</span>   <span class="c1"># Plane measurement settings</span>
<span class="hll"><span class="linenos">119</span>   <span class="n">do_plane_measurements</span> <span class="o">=</span> <span class="kc">False</span>
</span><span class="linenos">120</span>   <span class="n">plane_nnx</span><span class="p">,</span> <span class="n">plane_nny</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span>
<span class="linenos">121</span>   <span class="n">plane_x0</span><span class="p">,</span> <span class="n">plane_y0</span><span class="p">,</span> <span class="n">plane_z0</span> <span class="o">=</span> <span class="o">-</span><span class="n">Lx</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">Ly</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span>
<span class="linenos">122</span>   <span class="n">plane_Lx</span><span class="p">,</span> <span class="n">plane_Ly</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Lx</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Ly</span>
<span class="linenos">123</span>
<span class="linenos">124</span>   <span class="c1"># Line measurement settings</span>
<span class="hll"><span class="linenos">125</span>   <span class="n">do_line_measurements</span> <span class="o">=</span> <span class="kc">True</span>
</span><span class="linenos">126</span>   <span class="n">line_nmeas</span> <span class="o">=</span> <span class="mi">47</span>
<span class="linenos">127</span>   <span class="n">xstart</span><span class="p">,</span> <span class="n">xend</span> <span class="o">=</span> <span class="mf">0.23</span> <span class="o">+</span> <span class="p">((</span><span class="n">Lx</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="mf">49.19</span> <span class="o">+</span> <span class="p">((</span><span class="n">Ly</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="linenos">128</span>   <span class="n">ystart</span><span class="p">,</span> <span class="n">yend</span> <span class="o">=</span> <span class="n">Ly</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mf">0.221</span><span class="p">,</span> <span class="n">Ly</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mf">0.221</span>
<span class="linenos">129</span>   <span class="n">zstart</span><span class="p">,</span> <span class="n">zend</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>  <span class="c1"># 1m above surface.</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong>     (runtime: ~7 s)</span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">u</span> <span class="n">MTE</span><span class="o">.</span><span class="n">py</span> <span class="o">|</span> <span class="n">tee</span> <span class="n">log</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p zero_topo/restest/25_25_10 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</li>
<li><p>Run extra setup &amp; move files (3)</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">113</span><span class="c1"># Domain settings</span>
<span class="linenos">114</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">20</span>
<span class="hll"><span class="linenos">115</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span>
</span><span class="linenos">116</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">113</span><span class="c1"># Domain settings</span>
<span class="linenos">114</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">20</span>
<span class="hll"><span class="linenos">115</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">10</span>
</span><span class="linenos">116</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">113</span><span class="c1"># Domain settings</span>
<span class="linenos">114</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">20</span>
<span class="hll"><span class="linenos">115</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="mi">375</span><span class="p">,</span> <span class="mi">375</span><span class="p">,</span> <span class="mi">10</span>
</span><span class="linenos">116</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong>     (runtime: ~1 min, ~4 min, ~16 min)</span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">u</span> <span class="n">MTE</span><span class="o">.</span><span class="n">py</span> <span class="o">|</span> <span class="n">tee</span> <span class="n">log</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</div>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p zero_topo/restest/200_200_10 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p zero_topo/restest/375_375_10 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p zero_topo/restest/100_100_10 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p>Go to directory &amp; plot to visualize</p>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">zero_topo</span><span class="o">/</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/zero_topo/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gnuplot</span> <span class="n">plot_script_restest</span><span class="o">.</span><span class="n">p</span>
</pre></div>
</div>
</div>
</li>
</ol>
</details><details class="summary-how-to-reproduce-the-results-and-figures-for-synthetic-topography">
<summary>How to reproduce the results and figures for synthetic topography</summary><p>Please note basic setup in <a class="reference internal" href="usage.html#installation"><span class="std std-ref">Installation</span></a>.</p>
<ol class="arabic">
<li><p>In <code class="docutils literal notranslate"><span class="pre">MTE.py</span></code>, modify benchmark attribution to <code class="docutils literal notranslate"><span class="pre">5</span></code>, and make sure the right setup is used:</p>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="linenos">45</span><span class="n">benchmark</span> <span class="o">=</span> <span class="s1">&#39;5&#39;</span>
</span><span class="linenos">46</span>
<span class="linenos">47</span><span class="n">compute_vi</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Possible for all setups apart from DEM (-1).</span>
<span class="linenos">48</span><span class="k">if</span> <span class="n">compute_vi</span><span class="p">:</span>
<span class="linenos">49</span>   <span class="n">nqdim</span> <span class="o">=</span> <span class="mi">6</span>  <span class="c1"># Number of quadrature points, see documentation.</span>
<span class="linenos">50</span>
<span class="linenos">51</span><span class="c1">## ONLY BENCHMARK = -1 (DEM) &amp; BENCHMARK = 5 (FLANKSIM) ##</span>
<span class="hll"><span class="linenos">52</span><span class="n">flat_bottom</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># If True, a flat bottom is generated at the lower surface of the domain.</span>
</span><span class="linenos">53</span>                    <span class="c1"># Please see documentation, as the specific setup of this feature is different</span>
<span class="linenos">54</span>                    <span class="c1"># for the flank simulations and the DEM test.</span>
<span class="hll"><span class="linenos">55</span><span class="n">remove_zerotopo</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Setup run 2 times: 1st time, zero topography setup: xy coordinates</span>
</span><span class="linenos">56</span>                        <span class="c1"># of the observation points the same, but zerotopo domain and obs path</span>
<span class="linenos">57</span>                        <span class="c1"># shifted to average height DEM. 2nd time, &quot;regular&quot; run with topography.</span>
<span class="linenos">58</span>                        <span class="c1"># final results are 2nd run - 1 st run values. Run time can be improved,</span>
<span class="linenos">59</span>                        <span class="c1"># if 1st run was done with less el (and cuboid function), yet to be done.</span>
<span class="linenos">60</span>
<span class="linenos">61</span><span class="c1">## ONLY BENCHMARK = 5 (FLANKSIM) ##</span>
<span class="hll"><span class="linenos">62</span><span class="n">subbench</span> <span class="o">=</span> <span class="s1">&#39;south&#39;</span>  <span class="c1"># &#39;south&#39;, &#39;east&#39;, &#39;north&#39;, &#39;west&#39;, shifts topo features, and obs paths.</span>
</span></pre></div>
</div>
</div>
</li>
<li><p>Run first setup &amp; move files</p>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">217</span><span class="k">if</span> <span class="n">benchmark</span> <span class="o">==</span> <span class="s1">&#39;5&#39;</span><span class="p">:</span>
<span class="linenos">218</span>   <span class="c1"># General settings</span>
<span class="linenos">219</span>   <span class="n">do_spiral_measurements</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos">220</span>   <span class="n">do_path_measurements</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos">221</span>   <span class="n">compute_analytical</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos">222</span>
<span class="linenos">223</span>   <span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">224</span>   <span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">120</span>
</span><span class="hll"><span class="linenos">225</span>   <span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span>
</span><span class="linenos">226</span>   <span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
<span class="linenos">227</span>   <span class="c1">#Lx, Ly, Lz = 250, 250, 20</span>
<span class="linenos">228</span>   <span class="c1">#nelx, nely, nelz = int(Lx * 1.5), int(Ly * 1.5), 10</span>
<span class="linenos">229</span>
<span class="linenos">230</span>   <span class="c1"># Synthetic topography settings</span>
<span class="linenos">231</span>   <span class="n">wavelength</span> <span class="o">=</span> <span class="mi">25</span>
<span class="linenos">232</span>   <span class="n">A</span> <span class="o">=</span> <span class="mi">4</span>
<span class="linenos">233</span>   <span class="n">af</span> <span class="o">=</span> <span class="mi">6</span>
<span class="linenos">234</span>
<span class="linenos">235</span>   <span class="c1"># Line measurement settings</span>
<span class="linenos">236</span>   <span class="n">do_line_measurements</span> <span class="o">=</span> <span class="kc">True</span>
<span class="linenos">237</span>   <span class="n">line_nmeas</span> <span class="o">=</span> <span class="mi">47</span>
<span class="linenos">238</span>   <span class="n">xstart</span><span class="p">,</span> <span class="n">xend</span> <span class="o">=</span> <span class="mf">0.23</span> <span class="o">+</span> <span class="p">((</span><span class="n">Lx</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="mf">49.19</span> <span class="o">+</span> <span class="p">((</span><span class="n">Ly</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="linenos">239</span>   <span class="n">ystart</span><span class="p">,</span> <span class="n">yend</span> <span class="o">=</span> <span class="n">Ly</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mf">0.221</span><span class="p">,</span> <span class="n">Ly</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mf">0.221</span>
<span class="linenos">240</span>   <span class="n">zstart</span><span class="p">,</span> <span class="n">zend</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>  <span class="c1"># 1m above surface.</span>
<span class="linenos">241</span>
<span class="linenos">242</span>   <span class="c1"># Plane measurement settings</span>
<span class="linenos">243</span>   <span class="n">do_plane_measurements</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos">244</span>   <span class="n">plane_nnx</span><span class="p">,</span> <span class="n">plane_nny</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span>
<span class="linenos">245</span>   <span class="n">plane_x0</span><span class="p">,</span> <span class="n">plane_y0</span><span class="p">,</span> <span class="n">plane_z0</span> <span class="o">=</span> <span class="o">-</span><span class="n">Lx</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">Ly</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span>
<span class="linenos">246</span>   <span class="n">plane_Lx</span><span class="p">,</span> <span class="n">plane_Ly</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Lx</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Ly</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong>     (runtime: ~6 s)</span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">u</span> <span class="n">MTE</span><span class="o">.</span><span class="n">py</span> <span class="o">|</span> <span class="n">tee</span> <span class="n">log</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p flanksim_parameters/south/restest/10_10_10 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</li>
<li><p>Run extra setups &amp; move files (6)</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">223</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">224</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">240</span>
</span><span class="hll"><span class="linenos">225</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span>
</span><span class="linenos">226</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">223</span><span class="c1"># Domain settings</span>
<span class="linenos">224</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">120</span>
<span class="hll"><span class="linenos">225</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">10</span>
</span><span class="linenos">226</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">223</span><span class="c1"># Domain settings</span>
<span class="linenos">224</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">120</span>
<span class="hll"><span class="linenos">225</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">10</span>
</span><span class="linenos">226</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">223</span><span class="c1"># Domain settings</span>
<span class="linenos">224</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">120</span>
<span class="hll"><span class="linenos">225</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">10</span>
</span><span class="linenos">226</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">223</span><span class="c1"># Domain settings</span>
<span class="linenos">224</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">120</span>
<span class="hll"><span class="linenos">225</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">100</span>
</span><span class="linenos">226</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">223</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">224</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">240</span>
</span><span class="hll"><span class="linenos">225</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">10</span>
</span><span class="linenos">226</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong>     (runtime: ~6 s, ~12 s, ~35 s, ~1 min, ~12 min, ~1 min)</span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">u</span> <span class="n">MTE</span><span class="o">.</span><span class="n">py</span> <span class="o">|</span> <span class="n">tee</span> <span class="n">log</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</div>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p flanksim_parameters/south/restest/10_10_10_DD &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p flanksim_parameters/south/restest/25_25_10 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p flanksim_parameters/south/restest/50_50_10 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p flanksim_parameters/south/restest/75_75_10 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p flanksim_parameters/south/restest/75_75_100 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p flanksim_parameters/south/restest/75_75_10_DD &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p>Go to directory &amp; plot to visualize</p>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">flanksim_parameters</span><span class="o">/</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/flanksim_parameters/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gnuplot</span> <span class="n">plot_script_restest</span><span class="o">.</span><span class="n">p</span>
</pre></div>
</div>
</div>
</li>
</ol>
</details></section>
</section>
<section id="size">
<h2>Size<a class="headerlink" href="#size" title="Link to this heading"></a></h2>
<div class="line-block">
<div class="line">The size experiments will commence with a more compact domain and progressively expand it until the computed magnetic field at a point above the domain center stabilizes. The outcomes of changes in both the depth extent (z-direction) and spatial extent (xy-direction) will be analyzed.</div>
</div>
<div class="line-block">
<div class="line">However, upon adapting domain depth, a complication arises: the exact nature of the magnetization in the underlying flows and deeper is unknown. Nonetheless, a uniform magnetization is continuously assumed. This assumption now expands deeper, eventually stretching to the full pile of volcanic flows of Mount Etna. To validate this assumption for our case study, we refer to the geomagnetic history of Mount Etna. The last reversal of Earth’s magnetic field was dated around <span class="math notranslate nohighlight">\(\sim795\)</span> ka ago <span id="id4">[<a class="reference internal" href="ref.html#id46" title="Brad S. Singer, Brian R. Jicha, Nobutatsu Mochizuki, and Robert S. Coe. Synchronizing volcanic, sedimentary, and ice core records of Earth's last magnetic polarity reversal. Science advances, 8 2019. URL: https://doi.org/10.1126/sciadv.aaw4621, doi:10.1126/sciadv.aaw4621.">Singer <em>et al.</em>, 2019</a>]</span> and the first volcanic activity of Mount Etna was dated around <span class="math notranslate nohighlight">\(\sim500\)</span> ka ago <span id="id5">[<a class="reference internal" href="ref.html#id27" title="Stefano Branca, Mauro Coltelli, Emanuela De Beni, and Jan Wijbrans. Geological evolution of Mount Etna volcano (Italy) from earliest products until the first central volcanism (between 500 and 100 ka ago) inferred from geochronological and stratigraphic data. International Journal of Earth Sciences, 97(1):135-152, 2 2008. URL: https://doi.org/10.1007/s00531-006-0152-0, doi:10.1007/s00531-006-0152-0.">Branca <em>et al.</em>, 2008</a>]</span>.</div>
<div class="line">Therefore, no reversals are anticipated within the accumulated layers, allowing us to extend the depth for experimental purposes without restrictions. Nonetheless, as the directly underlying flow is deemed to exert the most substantial influence, expanding the depth beyond a singular flow might be redundant. The thickness of the flows underneath the field sites mentioned in <span id="id6">[<a class="reference internal" href="ref.html#id15" title="Romy Meyer and Lennart V. de Groot. Local magnetic anomalies in rugged volcanic terrain explain bias in paleomagnetic data: consequences for sampling. Geophysical Research Letters, 2023.">Meyer and de Groot, 2023</a>]</span> fluctuate between 5-15 meter <span id="id7">[<a class="reference internal" href="ref.html#id5" title="D Andronico, S Branca, S Calvari, M Burton, T Caltabiano, R A Corsaro, P Del Carlo, G Garfi, L Lodato, L Miraglia, F Mure, M Neri, E Pecora, M Pompilio, G Salerno, and L Spampinato. A multi-disciplinary study of the 2002-03 etna eruption: insights into a complex plumbing system. Bulletin of Volcanology, 67(4):314–330, 2005. 914kk Times Cited:171 Cited References Count:54. doi:10.1007/s00445-004-0372-8.">Andronico <em>et al.</em>, 2005</a>, <a class="reference internal" href="ref.html#id6" title="JB Murray and NF Stevens. New formulae for estimating lava flow volumes at mt. etna volcano, sicily. Bulletin of volcanology, 61(8):515–526, 2000.">Murray and Stevens, 2000</a>]</span>.</div>
</div>
<section id="id8">
<h3>Model setup<a class="headerlink" href="#id8" title="Link to this heading"></a></h3>
<div class="line-block">
<div class="line">Consequently, our tests explore domain depth ranging from 5 to 1800 meter, and a spatial extent from 50 to 1000 meters. The experiments will be done maintaining element resolution consistent with the previously established threshold at observation points along a path 1 meter above the surface.</div>
</div>
</section>
<section id="results-and-analysis">
<h3>Results and analysis<a class="headerlink" href="#results-and-analysis" title="Link to this heading"></a></h3>
<figure class="align-default" id="id19">
<span id="zt-low"></span><a class="reference internal image-reference" href="_images/zt_low.png"><img alt="_images/zt_low.png" src="_images/zt_low.png" style="width: 1120.0px; height: 420.0px;" /></a>
<figcaption>
<p><span class="caption-number">Figure 11 </span><span class="caption-text">Three subplots depicting the components of the computed magnetic field <strong>B</strong> for the size experiments. The numbers in the key relate to the length of each side of the domain (Lx_Ly_Lz). Please note, the y-axis varies between each subplot. For domains with spatial extent below 250x250 meter an edge effect is observed.</span><a class="headerlink" href="#id19" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="line-block">
<div class="line">In the investigations presented in <a class="reference internal" href="#zt-low"><span class="std std-numref">Figure 11</span></a>, spatial extents below 250x250 meters prominently display edge effects. This is particularly evident for the <span class="math notranslate nohighlight">\(B_y\)</span> component, which should ideally measure zero in the absence of topography or declination in magnetization. A uniform value across the observation path indicates the absence of edge effects, whereas variable values correlate with proximity to the domain edge.</div>
</div>
<figure class="align-default" id="id20">
<span id="zt-high-dif"></span><a class="reference internal image-reference" href="_images/zt_high_dif.png"><img alt="_images/zt_high_dif.png" src="_images/zt_high_dif.png" style="width: 1120.0px; height: 420.0px;" /></a>
<figcaption>
<p><span class="caption-number">Figure 12 </span><span class="caption-text">Three subplots depicting the components of the computed magnetic field <strong>B</strong> for the size experiments. The numbers in the key relate to the length of each side of the domain (Lx_Ly_Lz). Please note, the y-axis varies between each subplot.</span><a class="headerlink" href="#id20" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="line-block">
<div class="line">Our data reveals a nuanced relationship between the depth extent of the domain and the anomaly’s intensity, as evident in both <a class="reference internal" href="#zt-low"><span class="std std-numref">Figure 11</span></a> and <a class="reference internal" href="#zt-high-dif"><span class="std std-numref">Figure 12</span></a>. Notably, for components <span class="math notranslate nohighlight">\(B_x\)</span> and <span class="math notranslate nohighlight">\(B_z\)</span>, magnitude increases with depth in a non-linear fashion. An initial increase in depth (10 to 600 meters) yields a significant change in component values, but a subsequent increase from 600 to 1200 meters sees marginal differences. This relationship also depends on spatial extent. For instance, 500x500x40 and 250x250x20 meter configurations produce identical <span class="math notranslate nohighlight">\(B_x\)</span> and <span class="math notranslate nohighlight">\(B_z\)</span> values. Observations unveil three distinct patterns, see <a class="reference internal" href="#zt-high-dif"><span class="std std-numref">Figure 12</span></a>:</div>
</div>
<ol class="arabic simple">
<li><p>Identical values arise when both depth and spatial extent increase equivalently (e.g., <span class="math notranslate nohighlight">\(250\times250\times20\)</span> and <span class="math notranslate nohighlight">\(500\times500\times40\)</span> meters).</p></li>
<li><p>Increasing spatial extent alone reduces the magnitude proportionally (e.g., <span class="math notranslate nohighlight">\(250\times250\times20\)</span> and <span class="math notranslate nohighlight">\(500\times500\times20\)</span> meters).</p></li>
<li><p>Increasing depth alone enhances the magnitude proportionally (e.g., <span class="math notranslate nohighlight">\(500\times500\times20\)</span> and <span class="math notranslate nohighlight">\(500\times500\times40\)</span> meters).</p></li>
</ol>
<div class="line-block">
<div class="line">It is important to highlight that the inclination values are consistent across different setups, given that the modulating factor for both <span class="math notranslate nohighlight">\(B_x\)</span> and <span class="math notranslate nohighlight">\(B_z\)</span> remains identical.</div>
</div>
<figure class="align-default" id="id21">
<span id="extest-comp-mp-high"></span><a class="reference internal image-reference" href="_images/extest_comp_mp_high.png"><img alt="_images/extest_comp_mp_high.png" src="_images/extest_comp_mp_high.png" style="width: 1120.0px; height: 420.0px;" /></a>
<figcaption>
<p><span class="caption-number">Figure 13 </span><span class="caption-text">Three subplots depicting the components of the computed magnetic field <strong>B</strong> for the depth experiments. Size and depth of the domain were varied, the resolution and relative location (centered in the domain) of the observation path were constant. Components were rotated to align with Pmag coordinate system. The numbers in the key relate to the length of each side of the domain (Lx_Ly_Lz). Please note, the y-axis varies between each subplot.</span><a class="headerlink" href="#id21" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="line-block">
<div class="line"><a class="reference internal" href="#extest-comp-mp-high"><span class="std std-numref">Figure 13</span></a> display the outcomes from testing the domain size constraints on a simulation with topography, and displays similar trends with respect to required spatial extent and relationship between spatial dimension and magnitude of components. Extending the depth and spatial extent has a proportional impact on the magnitude of the <span class="math notranslate nohighlight">\(B_z\)</span> and <span class="math notranslate nohighlight">\(B_x\)</span> components.</div>
</div>
<section id="id9">
<h4>Reproduce<a class="headerlink" href="#id9" title="Link to this heading"></a></h4>
<details class="summary-how-to-reproduce-the-results-and-figures-for-zero-topography">
<summary>How to reproduce the results and figures for zero topography</summary><p>Please note basic setup in <a class="reference internal" href="usage.html#installation"><span class="std std-ref">Installation</span></a>.</p>
<ol class="arabic">
<li><p>In <code class="docutils literal notranslate"><span class="pre">MTE.py</span></code>, modify benchmark attribution to <code class="docutils literal notranslate"><span class="pre">2a</span></code>:</p>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="linenos">45</span><span class="n">benchmark</span> <span class="o">=</span> <span class="s1">&#39;2a&#39;</span>
</span></pre></div>
</div>
</div>
</li>
<li><p>Run first setup &amp; move files</p>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">106</span><span class="k">if</span> <span class="n">benchmark</span> <span class="o">==</span> <span class="s1">&#39;2a&#39;</span><span class="p">:</span>
<span class="linenos">107</span>   <span class="c1"># General settings</span>
<span class="linenos">108</span>   <span class="n">remove_zerotopo</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos">109</span>   <span class="n">compute_analytical</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos">110</span>   <span class="n">do_spiral_measurements</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos">111</span>   <span class="n">do_path_measurements</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos">112</span>
<span class="linenos">113</span>   <span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">114</span>   <span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">20</span>
</span><span class="hll"><span class="linenos">115</span>   <span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span><span class="p">),</span> <span class="mi">10</span>
</span><span class="hll"><span class="linenos">116</span>   <span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>  <span class="c1"># Magnetization [A/m].</span>
</span><span class="linenos">117</span>
<span class="linenos">118</span>   <span class="c1"># Plane measurement settings</span>
<span class="hll"><span class="linenos">119</span>   <span class="n">do_plane_measurements</span> <span class="o">=</span> <span class="kc">False</span>
</span><span class="linenos">120</span>   <span class="n">plane_nnx</span><span class="p">,</span> <span class="n">plane_nny</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span>
<span class="linenos">121</span>   <span class="n">plane_x0</span><span class="p">,</span> <span class="n">plane_y0</span><span class="p">,</span> <span class="n">plane_z0</span> <span class="o">=</span> <span class="o">-</span><span class="n">Lx</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">Ly</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span>
<span class="linenos">122</span>   <span class="n">plane_Lx</span><span class="p">,</span> <span class="n">plane_Ly</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Lx</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Ly</span>
<span class="linenos">123</span>
<span class="linenos">124</span>   <span class="c1"># Line measurement settings</span>
<span class="hll"><span class="linenos">125</span>   <span class="n">do_line_measurements</span> <span class="o">=</span> <span class="kc">True</span>
</span><span class="linenos">126</span>   <span class="n">line_nmeas</span> <span class="o">=</span> <span class="mi">47</span>
<span class="linenos">127</span>   <span class="n">xstart</span><span class="p">,</span> <span class="n">xend</span> <span class="o">=</span> <span class="mf">0.23</span> <span class="o">+</span> <span class="p">((</span><span class="n">Lx</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="mf">49.19</span> <span class="o">+</span> <span class="p">((</span><span class="n">Ly</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="linenos">128</span>   <span class="n">ystart</span><span class="p">,</span> <span class="n">yend</span> <span class="o">=</span> <span class="n">Ly</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mf">0.221</span><span class="p">,</span> <span class="n">Ly</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mf">0.221</span>
<span class="linenos">129</span>   <span class="n">zstart</span><span class="p">,</span> <span class="n">zend</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>  <span class="c1"># 1m above surface.</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong>     (runtime: ~20 s)</span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">u</span> <span class="n">MTE</span><span class="o">.</span><span class="n">py</span> <span class="o">|</span> <span class="n">tee</span> <span class="n">log</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p zero_topo/50_50_20 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</li>
<li><p>Run extra setups &amp; move files (16)</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">113</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">114</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">120</span>
</span><span class="linenos">115</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span><span class="p">),</span> <span class="mi">10</span>
<span class="linenos">116</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">113</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">114</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">20</span>
</span><span class="linenos">115</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span><span class="p">),</span> <span class="mi">10</span>
<span class="linenos">116</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">113</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">114</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span>
</span><span class="linenos">115</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span><span class="p">),</span> <span class="mi">10</span>
<span class="linenos">116</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">113</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">114</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">240</span>
</span><span class="linenos">115</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span><span class="p">),</span> <span class="mi">10</span>
<span class="linenos">116</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">113</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">114</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">5</span>
</span><span class="linenos">115</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span><span class="p">),</span> <span class="mi">10</span>
<span class="linenos">116</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">113</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">114</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">10</span>
</span><span class="linenos">115</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span><span class="p">),</span> <span class="mi">10</span>
<span class="linenos">116</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">113</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">114</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">20</span>
</span><span class="linenos">115</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span><span class="p">),</span> <span class="mi">10</span>
<span class="linenos">116</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">113</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">114</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">40</span>
</span><span class="linenos">115</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span><span class="p">),</span> <span class="mi">10</span>
<span class="linenos">116</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">113</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">114</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">600</span>
</span><span class="linenos">115</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span><span class="p">),</span> <span class="mi">10</span>
<span class="linenos">116</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">113</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">114</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">1200</span>
</span><span class="linenos">115</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span><span class="p">),</span> <span class="mi">10</span>
<span class="linenos">116</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">113</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">114</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">20</span>
</span><span class="linenos">115</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span><span class="p">),</span> <span class="mi">10</span>
<span class="linenos">116</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">113</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">114</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">40</span>
</span><span class="linenos">115</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span><span class="p">),</span> <span class="mi">10</span>
<span class="linenos">116</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">113</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">114</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1200</span>
</span><span class="linenos">115</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span><span class="p">),</span> <span class="mi">10</span>
<span class="linenos">116</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">113</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">114</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">20</span>
</span><span class="linenos">115</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span><span class="p">),</span> <span class="mi">10</span>
<span class="linenos">116</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">113</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">114</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">1800</span>
</span><span class="linenos">115</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span><span class="p">),</span> <span class="mi">10</span>
<span class="linenos">116</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">113</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">114</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">20</span>
</span><span class="linenos">115</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span><span class="p">),</span> <span class="mi">10</span>
<span class="linenos">116</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong> (runtime: ~20 s, ~1 min, ~1 min, ~1 min, ~7 min, ~7 min, ~7 min, ~7 min, ~7 min, ~7 min, ~30 min, ~30 min, ~30 min, ~1 hr, ~1 hr, ~2 hr)</span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">u</span> <span class="n">MTE</span><span class="o">.</span><span class="n">py</span> <span class="o">|</span> <span class="n">tee</span> <span class="n">log</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</div>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p zero_topo/50_50_120 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p zero_topo/100_100_20 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p zero_topo/100_100_120 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p zero_topo/100_100_240 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p zero_topo/250_250_5 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p zero_topo/250_250_10 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p zero_topo/250_250_20 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p zero_topo/250_250_40 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p zero_topo/250_250_600 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p zero_topo/250_250_1200 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p zero_topo/500_500_20 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p zero_topo/500_500_40 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p zero_topo/500_500_1200 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p zero_topo/500_500_1200 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p zero_topo/750_750_1800 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p zero_topo/1000_1000_20 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p>Go to directory &amp; plot to visualize</p>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">zero_topo</span><span class="o">/</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/zero_topo/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gnuplot</span> <span class="n">plot_script_extest</span><span class="o">.</span><span class="n">p</span>
</pre></div>
</div>
</div>
</li>
</ol>
</details><details class="summary-how-to-reproduce-the-results-and-figures-for-synthetic-topography">
<summary>How to reproduce the results and figures for synthetic topography</summary><p>Please note basic setup in <a class="reference internal" href="usage.html#installation"><span class="std std-ref">Installation</span></a>.</p>
<ol class="arabic">
<li><p>In <code class="docutils literal notranslate"><span class="pre">MTE.py</span></code>, modify benchmark attribution to <code class="docutils literal notranslate"><span class="pre">5</span></code>, and make sure the right setup is used:</p>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="linenos">45</span><span class="n">benchmark</span> <span class="o">=</span> <span class="s1">&#39;5&#39;</span>
</span><span class="linenos">46</span>
<span class="linenos">47</span><span class="n">compute_vi</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Possible for all setups apart from DEM (-1).</span>
<span class="linenos">48</span><span class="k">if</span> <span class="n">compute_vi</span><span class="p">:</span>
<span class="linenos">49</span>   <span class="n">nqdim</span> <span class="o">=</span> <span class="mi">6</span>  <span class="c1"># Number of quadrature points, see documentation.</span>
<span class="linenos">50</span>
<span class="linenos">51</span><span class="c1">## ONLY BENCHMARK = -1 (DEM) &amp; BENCHMARK = 5 (FLANKSIM) ##</span>
<span class="hll"><span class="linenos">52</span><span class="n">flat_bottom</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># If True, a flat bottom is generated at the lower surface of the domain.</span>
</span><span class="linenos">53</span>                    <span class="c1"># Please see documentation, as the specific setup of this feature is different</span>
<span class="linenos">54</span>                    <span class="c1"># for the flank simulations and the DEM test.</span>
<span class="hll"><span class="linenos">55</span><span class="n">remove_zerotopo</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Setup run 2 times: 1st time, zero topography setup: xy coordinates</span>
</span><span class="linenos">56</span>                        <span class="c1"># of the observation points the same, but zerotopo domain and obs path</span>
<span class="linenos">57</span>                        <span class="c1"># shifted to average height DEM. 2nd time, &quot;regular&quot; run with topography.</span>
<span class="linenos">58</span>                        <span class="c1"># final results are 2nd run - 1 st run values. Run time can be improved,</span>
<span class="linenos">59</span>                        <span class="c1"># if 1st run was done with less el (and cuboid function), yet to be done.</span>
<span class="linenos">60</span>
<span class="linenos">61</span><span class="c1">## ONLY BENCHMARK = 5 (FLANKSIM) ##</span>
<span class="hll"><span class="linenos">62</span><span class="n">subbench</span> <span class="o">=</span> <span class="s1">&#39;south&#39;</span>  <span class="c1"># &#39;south&#39;, &#39;east&#39;, &#39;north&#39;, &#39;west&#39;, shifts topo features, and obs paths.</span>
</span></pre></div>
</div>
</div>
</li>
<li><p>Run first setup &amp; move files</p>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">217</span><span class="k">if</span> <span class="n">benchmark</span> <span class="o">==</span> <span class="s1">&#39;5&#39;</span><span class="p">:</span>
<span class="linenos">218</span>   <span class="c1"># General settings</span>
<span class="linenos">219</span>   <span class="n">do_spiral_measurements</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos">220</span>   <span class="n">do_path_measurements</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos">221</span>   <span class="n">compute_analytical</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos">222</span>
<span class="linenos">223</span>   <span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">224</span>   <span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">5</span>
</span><span class="hll"><span class="linenos">225</span>   <span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">),</span> <span class="mi">10</span>
</span><span class="linenos">226</span>   <span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
<span class="hll"><span class="linenos">227</span>   <span class="c1">#Lx, Ly, Lz = 50, 50, 120</span>
</span><span class="hll"><span class="linenos">228</span>   <span class="c1">#nelx, nely, nelz = 10, 10, 10</span>
</span><span class="linenos">229</span>
<span class="linenos">230</span>   <span class="c1"># Synthetic topography settings</span>
<span class="linenos">231</span>   <span class="n">wavelength</span> <span class="o">=</span> <span class="mi">25</span>
<span class="linenos">232</span>   <span class="n">A</span> <span class="o">=</span> <span class="mi">4</span>
<span class="linenos">233</span>   <span class="n">af</span> <span class="o">=</span> <span class="mi">6</span>
<span class="linenos">234</span>
<span class="linenos">235</span>   <span class="c1"># Line measurement settings</span>
<span class="linenos">236</span>   <span class="n">do_line_measurements</span> <span class="o">=</span> <span class="kc">True</span>
<span class="linenos">237</span>   <span class="n">line_nmeas</span> <span class="o">=</span> <span class="mi">47</span>
<span class="linenos">238</span>   <span class="n">xstart</span><span class="p">,</span> <span class="n">xend</span> <span class="o">=</span> <span class="mf">0.23</span> <span class="o">+</span> <span class="p">((</span><span class="n">Lx</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="mf">49.19</span> <span class="o">+</span> <span class="p">((</span><span class="n">Ly</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="linenos">239</span>   <span class="n">ystart</span><span class="p">,</span> <span class="n">yend</span> <span class="o">=</span> <span class="n">Ly</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mf">0.221</span><span class="p">,</span> <span class="n">Ly</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mf">0.221</span>
<span class="linenos">240</span>   <span class="n">zstart</span><span class="p">,</span> <span class="n">zend</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>  <span class="c1"># 1m above surface.</span>
<span class="linenos">241</span>
<span class="linenos">242</span>   <span class="c1"># Plane measurement settings</span>
<span class="linenos">243</span>   <span class="n">do_plane_measurements</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos">244</span>   <span class="n">plane_nnx</span><span class="p">,</span> <span class="n">plane_nny</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span>
<span class="linenos">245</span>   <span class="n">plane_x0</span><span class="p">,</span> <span class="n">plane_y0</span><span class="p">,</span> <span class="n">plane_z0</span> <span class="o">=</span> <span class="o">-</span><span class="n">Lx</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">Ly</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span>
<span class="linenos">246</span>   <span class="n">plane_Lx</span><span class="p">,</span> <span class="n">plane_Ly</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Lx</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Ly</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong> (runtime: ~30 min)</span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">u</span> <span class="n">MTE</span><span class="o">.</span><span class="n">py</span> <span class="o">|</span> <span class="n">tee</span> <span class="n">log</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p flanksim_parameters/south/extest/250_250_5 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</li>
<li><p>Run extra setups &amp; move files (5)</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">223</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">224</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">10</span>
</span></pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">223</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">224</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">20</span>
</span></pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">223</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">224</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">40</span>
</span></pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">223</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">224</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">20</span>
</span></pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">223</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">224</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">20</span>
</span></pre></div>
</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong> (runtime: ~30 min, ~30 min, ~30 min, ~2 hr, ~8 hr)</span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">u</span> <span class="n">MTE</span><span class="o">.</span><span class="n">py</span> <span class="o">|</span> <span class="n">tee</span> <span class="n">log</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</div>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p flanksim_parameters/south/extest/250_250_10 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p flanksim_parameters/south/extest/250_250_20 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p flanksim_parameters/south/extest/250_250_40 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p flanksim_parameters/south/extest/500_500_20 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p flanksim_parameters/south/extest/1000_1000_20 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p>Go to directory &amp; plot to visualize</p>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">flanksim_parameters</span><span class="o">/</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/flanksim_parameters/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gnuplot</span> <span class="n">plot_script_extest</span><span class="o">.</span><span class="n">p</span>
</pre></div>
</div>
</div>
</li>
</ol>
</details></section>
</section>
<section id="verification">
<h3>Verification<a class="headerlink" href="#verification" title="Link to this heading"></a></h3>
<figure class="align-default" id="id22">
<span id="zt-sivi"></span><a class="reference internal image-reference" href="_images/zt_sivi.png"><img alt="_images/zt_sivi.png" src="_images/zt_sivi.png" style="width: 1120.0px; height: 420.0px;" /></a>
<figcaption>
<p><span class="caption-number">Figure 14 </span><span class="caption-text">Three subplots depicting the components of the computed magnetic field <strong>B</strong> for flat-terrain experiments. The spatial extent of the domain is varies, while adhering the threshold resolution. The numbers in the key relate to the length of each side of the domain (Lx_Ly_Lz). Results annotated with VI were computed using the volume integral, those with SI were computed using the surface integral. Please note, the y-axis varies between each subplot.</span><a class="headerlink" href="#id22" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="line-block">
<div class="line">3D Gauss-Legendre quadrature rules were adopted to numerically determine the volume integral (see equation <a class="reference internal" href="app1.html#equation-eq-10-2">(19)</a>). This methodology served as a reference due to the absence of published benchmarks. Remarkably, our essentially analytical solutions align closely with the numerical approximations, see <a class="reference internal" href="#zt-sivi"><span class="std std-numref">Figure 14</span></a>, which suggests that the observed trends are not computational but more theoretical in nature.</div>
</div>
<section id="id10">
<h4>Reproduce<a class="headerlink" href="#id10" title="Link to this heading"></a></h4>
<details class="summary-how-to-reproduce-the-results-and-figures-for-zero-topography">
<summary>How to reproduce the results and figures for zero topography</summary><p>Please note basic setup in <a class="reference internal" href="usage.html#installation"><span class="std std-ref">Installation</span></a>.</p>
<ol class="arabic">
<li><p>In <code class="docutils literal notranslate"><span class="pre">MTE.py</span></code>, modify benchmark attribution to <code class="docutils literal notranslate"><span class="pre">2a</span></code>:</p>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="linenos">45</span><span class="n">benchmark</span> <span class="o">=</span> <span class="s1">&#39;2a&#39;</span>
</span><span class="linenos">46</span>
<span class="hll"><span class="linenos">47</span><span class="n">compute_vi</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Possible for all setups apart from DEM (-1).</span>
</span><span class="linenos">48</span><span class="k">if</span> <span class="n">compute_vi</span><span class="p">:</span>
<span class="hll"><span class="linenos">49</span>   <span class="n">nqdim</span> <span class="o">=</span> <span class="mi">6</span>  <span class="c1"># Number of quadrature points, see documentation.</span>
</span></pre></div>
</div>
</div>
</li>
<li><p>Run first setup &amp; move files</p>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">106</span><span class="k">if</span> <span class="n">benchmark</span> <span class="o">==</span> <span class="s1">&#39;2a&#39;</span><span class="p">:</span>
<span class="linenos">107</span>   <span class="c1"># General settings</span>
<span class="linenos">108</span>   <span class="n">remove_zerotopo</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos">109</span>   <span class="n">compute_analytical</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos">110</span>   <span class="n">do_spiral_measurements</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos">111</span>   <span class="n">do_path_measurements</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos">112</span>
<span class="linenos">113</span>   <span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">114</span>   <span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">10</span>
</span><span class="hll"><span class="linenos">115</span>   <span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span><span class="p">),</span> <span class="mi">10</span>
</span><span class="hll"><span class="linenos">116</span>   <span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>  <span class="c1"># Magnetization [A/m].</span>
</span><span class="linenos">117</span>
<span class="linenos">118</span>   <span class="c1"># Plane measurement settings</span>
<span class="hll"><span class="linenos">119</span>   <span class="n">do_plane_measurements</span> <span class="o">=</span> <span class="kc">False</span>
</span><span class="linenos">120</span>   <span class="n">plane_nnx</span><span class="p">,</span> <span class="n">plane_nny</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span>
<span class="linenos">121</span>   <span class="n">plane_x0</span><span class="p">,</span> <span class="n">plane_y0</span><span class="p">,</span> <span class="n">plane_z0</span> <span class="o">=</span> <span class="o">-</span><span class="n">Lx</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">Ly</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span>
<span class="linenos">122</span>   <span class="n">plane_Lx</span><span class="p">,</span> <span class="n">plane_Ly</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Lx</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Ly</span>
<span class="linenos">123</span>
<span class="linenos">124</span>   <span class="c1"># Line measurement settings</span>
<span class="hll"><span class="linenos">125</span>   <span class="n">do_line_measurements</span> <span class="o">=</span> <span class="kc">True</span>
</span><span class="linenos">126</span>   <span class="n">line_nmeas</span> <span class="o">=</span> <span class="mi">47</span>
<span class="linenos">127</span>   <span class="n">xstart</span><span class="p">,</span> <span class="n">xend</span> <span class="o">=</span> <span class="mf">0.23</span> <span class="o">+</span> <span class="p">((</span><span class="n">Lx</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="mf">49.19</span> <span class="o">+</span> <span class="p">((</span><span class="n">Ly</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="linenos">128</span>   <span class="n">ystart</span><span class="p">,</span> <span class="n">yend</span> <span class="o">=</span> <span class="n">Ly</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mf">0.221</span><span class="p">,</span> <span class="n">Ly</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mf">0.221</span>
<span class="linenos">129</span>   <span class="n">zstart</span><span class="p">,</span> <span class="n">zend</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>  <span class="c1"># 1m above surface.</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong> (runtime: ~2.5 hr)</span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">u</span> <span class="n">MTE</span><span class="o">.</span><span class="n">py</span> <span class="o">|</span> <span class="n">tee</span> <span class="n">log</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p zero_topo/250_250_10_wvi &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</li>
<li><p>Run extra setups &amp; move files (3)</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">113</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">114</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">20</span>
</span><span class="linenos">115</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span><span class="p">),</span> <span class="mi">10</span>
<span class="linenos">116</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">113</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">114</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">20</span>
</span><span class="linenos">115</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span><span class="p">),</span> <span class="mi">10</span>
<span class="linenos">116</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">113</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">114</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">40</span>
</span><span class="linenos">115</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span><span class="p">),</span> <span class="mi">10</span>
<span class="linenos">116</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
</pre></div>
</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong> (runtime: ~2.5 hr, ~10 hr, ~10 hr)</span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">u</span> <span class="n">MTE</span><span class="o">.</span><span class="n">py</span> <span class="o">|</span> <span class="n">tee</span> <span class="n">log</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</div>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p zero_topo/250_250_20_wvi &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p zero_topo/500_500_20_wvi &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p zero_topo/500_500_40_wvi &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p>Go to directory &amp; plot to visualize</p>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">zero_topo</span><span class="o">/</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/zero_topo/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gnuplot</span> <span class="n">plot_script_visi</span><span class="o">.</span><span class="n">p</span>
</pre></div>
</div>
</div>
</li>
</ol>
</details></section>
</section>
<section id="challenges-in-setup-optimization">
<h3>Challenges in Setup Optimization<a class="headerlink" href="#challenges-in-setup-optimization" title="Link to this heading"></a></h3>
<div class="line-block">
<div class="line">Determining the optimal setup for the size of the domain now poses challenges. While increasing domain size might intuitively stabilize computed values, <a class="reference internal" href="#extest-comp-mp-high"><span class="std std-numref">Figure 13</span></a>, <a class="reference internal" href="#zt-low"><span class="std std-numref">Figure 11</span></a> and <a class="reference internal" href="#zt-high-dif"><span class="std std-numref">Figure 12</span></a> contradict this presumption. While consistent depth expansion appears to eventually plateau the results, increasing depth continues to influence the magnitudes of the <span class="math notranslate nohighlight">\(B_x\)</span> and <span class="math notranslate nohighlight">\(B_z\)</span> components, as illustrated in various depth configurations with a spatial layout of 250x250 in <a class="reference internal" href="#zt-low"><span class="std std-numref">Figure 11</span></a>. Moreover, when comparing deeper configurations like <span class="math notranslate nohighlight">\(500\times500\times1800\)</span> with <span class="math notranslate nohighlight">\(500\times500\times20\)</span> meters in <a class="reference internal" href="#zt-low"><span class="std std-numref">Figure 11</span></a>, a pronounced amplification of edge effects for the <span class="math notranslate nohighlight">\(B_y\)</span> component is evident. This observation aligns with recommendations from the foundational study by <span id="id11">[<a class="reference internal" href="ref.html#id26" title="M. H. P. Bott. Two methods applicable to computers for evaluating magnetic anomalies due to finite three dimensional bodies. Geophysical Prospecting, 11(3):292-299, 1963. URL: https://www.earthdoc.org/content/journals/10.1111/j.1365-2478.1963.tb02039.x, doi:https://doi.org/10.1111/j.1365-2478.1963.tb02039.x.">Bott, 1963</a>]</span>, suggesting that optimal results emerge when the depth is substantially less than the areal extent.</div>
<div class="line">Nevertheless, this observation does not offer clarity in distinguishing between configurations of shallower depths but varied spatial dimensions, such as <span class="math notranslate nohighlight">\(250\times250\times10\)</span>, <span class="math notranslate nohighlight">\(250\times250\times20\)</span>, <span class="math notranslate nohighlight">\(500\times500\times20\)</span>, <span class="math notranslate nohighlight">\(500\times500\times40\)</span> meters. Still, by examining <a class="reference internal" href="#extest-comp-mp-high"><span class="std std-numref">Figure 13</span></a>, it becomes apparent that magnitude differences for these setups are minimal when juxtaposed with anomalies caused by topography.</div>
</div>
<figure class="align-default" id="id23">
<span id="vis-flanksim-zt"></span><a class="reference internal image-reference" href="_images/vis_flanksim_zt.png"><img alt="_images/vis_flanksim_zt.png" src="_images/vis_flanksim_zt.png" style="width: 834.0px; height: 421.8px;" /></a>
<figcaption>
<p><span class="caption-number">Figure 15 </span><span class="caption-text">Visualization of Southern flank and flat-terrain model setup. The flat-terrain setup is set to a lower opacity, to show the intersection between the two domains. The observation points for both setups are at the same xy-coordinates, only the z-coordinate differs. Furthermore, the thickness of the flat-terrain domain is equal to the depth of the topography setup underneath the observation path.</span><a class="headerlink" href="#id23" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id24">
<span id="topo-zt-fb-comp"></span><a class="reference internal image-reference" href="_images/topo_zt_fb_comp.png"><img alt="_images/topo_zt_fb_comp.png" src="_images/topo_zt_fb_comp.png" style="width: 1120.0px; height: 420.0px;" /></a>
<figcaption>
<p><span class="caption-number">Figure 16 </span><span class="caption-text">Three subplots depicting the components of the computed magnetic field <strong>B</strong> for the depth experiments. The numbers in the key relate to the length of each side of the domain (Lx_Ly_Lz). Please note, the y-axis varies between each subplot.</span><a class="headerlink" href="#id24" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="line-block">
<div class="line">Significantly, when offsetting the computed values at the observation points for a flat-terrain model with matching dimensions from those of the topographic model, the discrepancies nearly converge into a single solution, as illustrated in <a class="reference internal" href="#topo-zt-fb-comp"><span class="std std-numref">Figure 16</span></a>. The residual minor fluctuations in the <span class="math notranslate nohighlight">\(B_x\)</span> components across various domain sizes may stem from the incline of the topographic model. In consideration that this method essentially involves subtracting a rectangular prism from the simulation of the southern slope, which ascends northward, see <a class="reference internal" href="#vis-flanksim-zt"><span class="std std-numref">Figure 15</span></a>.</div>
</div>
<figure class="align-default" id="id25">
<span id="topo-zt-fb-sloped"></span><a class="reference internal image-reference" href="_images/topo_zt_fb_sloped.png"><img alt="_images/topo_zt_fb_sloped.png" src="_images/topo_zt_fb_sloped.png" style="width: 1120.0px; height: 420.0px;" /></a>
<figcaption>
<p><span class="caption-number">Figure 17 </span><span class="caption-text">Three subplots depicting the components of the computed magnetic field <strong>B</strong> for the depth experiments. The numbers in the key relate to the length of each side of the domain (Lx_Ly_Lz). Please note, the y-axis varies between each subplot.</span><a class="headerlink" href="#id25" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>As evidenced in <a class="reference internal" href="#topo-zt-fb-sloped"><span class="std std-numref">Figure 17</span></a>, removing a sloped “flat”-terrain model from the calculations causes the solutions for all domain sizes to merge into a single solution, which also, unfortunately, removes the slope’s effect from the output. This removal is counterproductive since lava flows predominantly settle on volcanic slopes.</p>
<div class="line-block">
<div class="line">Therefore, and again highlighting that these anomalies are small compared to the topographic anomalies being studies, it is recommended for more complex domain configurations to remove flat-terrain model’s results to cancel out any effects of the domain size on the findings. Future investigation should also meticulously evaluate the role of both the depth and the spatial extent of the domain. It is important to note that the flat-terrain domain, chosen for subtraction, was configured with a vertical span equal to the depth of the domain underneath the observation path, aligning with elements that most significantly affect the final calculations.</div>
</div>
<div class="line-block">
<div class="line">This study’s focal point is the influence of topography on magnetic field readings above a flow, thus, this subtraction technique is adequate for alleviating complications linked to domain size and the magnitude of the resultant anomaly. A key takeaway is that maintaining <strong>a spatial size above or equal to 250x250 meter</strong>, where the depth is considerably less than the spatial dimension, is crucial.</div>
</div>
<section id="id12">
<h4>Reproduce<a class="headerlink" href="#id12" title="Link to this heading"></a></h4>
<details class="summary-how-to-reproduce-the-results-and-figures-for-synthetic-topography">
<summary>How to reproduce the results and figures for synthetic topography</summary><p>Please note basic setup in <a class="reference internal" href="usage.html#installation"><span class="std std-ref">Installation</span></a>.</p>
<ol class="arabic">
<li><p>In <code class="docutils literal notranslate"><span class="pre">MTE.py</span></code>, modify benchmark attribution to <code class="docutils literal notranslate"><span class="pre">5</span></code>, and make sure the right setup is used:</p>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="linenos">45</span><span class="n">benchmark</span> <span class="o">=</span> <span class="s1">&#39;5&#39;</span>
</span><span class="linenos">46</span>
<span class="hll"><span class="linenos">47</span><span class="n">compute_vi</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Possible for all setups apart from DEM (-1).</span>
</span><span class="linenos">48</span><span class="k">if</span> <span class="n">compute_vi</span><span class="p">:</span>
<span class="linenos">49</span>   <span class="n">nqdim</span> <span class="o">=</span> <span class="mi">6</span>  <span class="c1"># Number of quadrature points, see documentation.</span>
<span class="linenos">50</span>
<span class="linenos">51</span><span class="c1">## ONLY BENCHMARK = -1 (DEM) &amp; BENCHMARK = 5 (FLANKSIM) ##</span>
<span class="hll"><span class="linenos">52</span><span class="n">flat_bottom</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># If True, a flat bottom is generated at the lower surface of the domain.</span>
</span><span class="linenos">53</span>                    <span class="c1"># Please see documentation, as the specific setup of this feature is different</span>
<span class="linenos">54</span>                    <span class="c1"># for the flank simulations and the DEM test.</span>
<span class="hll"><span class="linenos">55</span><span class="n">remove_zerotopo</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Setup run 2 times: 1st time, zero topography setup: xy coordinates</span>
</span><span class="linenos">56</span>                        <span class="c1"># of the observation points the same, but zerotopo domain and obs path</span>
<span class="linenos">57</span>                        <span class="c1"># shifted to average height DEM. 2nd time, &quot;regular&quot; run with topography.</span>
<span class="linenos">58</span>                        <span class="c1"># final results are 2nd run - 1 st run values. Run time can be improved,</span>
<span class="linenos">59</span>                        <span class="c1"># if 1st run was done with less el (and cuboid function), yet to be done.</span>
<span class="linenos">60</span>
<span class="linenos">61</span><span class="c1">## ONLY BENCHMARK = 5 (FLANKSIM) ##</span>
<span class="hll"><span class="linenos">62</span><span class="n">subbench</span> <span class="o">=</span> <span class="s1">&#39;south&#39;</span>  <span class="c1"># &#39;south&#39;, &#39;east&#39;, &#39;north&#39;, &#39;west&#39;, shifts topo features, and obs paths.</span>
</span></pre></div>
</div>
</div>
</li>
<li><p>Run first setup &amp; move files</p>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">217</span><span class="k">if</span> <span class="n">benchmark</span> <span class="o">==</span> <span class="s1">&#39;5&#39;</span><span class="p">:</span>
<span class="linenos">218</span>   <span class="c1"># General settings</span>
<span class="linenos">219</span>   <span class="n">do_spiral_measurements</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos">220</span>   <span class="n">do_path_measurements</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos">221</span>   <span class="n">compute_analytical</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos">222</span>
<span class="linenos">223</span>   <span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">224</span>   <span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">5</span>
</span><span class="hll"><span class="linenos">225</span>   <span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">),</span> <span class="mi">10</span>
</span><span class="linenos">226</span>   <span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
<span class="linenos">227</span>   <span class="c1">#Lx, Ly, Lz = 50, 50, 120</span>
<span class="linenos">228</span>   <span class="c1">#nelx, nely, nelz = 10, 10, 10</span>
<span class="linenos">229</span>
<span class="linenos">230</span>   <span class="c1"># Synthetic topography settings</span>
<span class="linenos">231</span>   <span class="n">wavelength</span> <span class="o">=</span> <span class="mi">25</span>
<span class="linenos">232</span>   <span class="n">A</span> <span class="o">=</span> <span class="mi">4</span>
<span class="linenos">233</span>   <span class="n">af</span> <span class="o">=</span> <span class="mi">6</span>
<span class="linenos">234</span>
<span class="linenos">235</span>   <span class="c1"># Line measurement settings</span>
<span class="linenos">236</span>   <span class="n">do_line_measurements</span> <span class="o">=</span> <span class="kc">True</span>
<span class="linenos">237</span>   <span class="n">line_nmeas</span> <span class="o">=</span> <span class="mi">47</span>
<span class="linenos">238</span>   <span class="n">xstart</span><span class="p">,</span> <span class="n">xend</span> <span class="o">=</span> <span class="mf">0.23</span> <span class="o">+</span> <span class="p">((</span><span class="n">Lx</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="mf">49.19</span> <span class="o">+</span> <span class="p">((</span><span class="n">Ly</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="linenos">239</span>   <span class="n">ystart</span><span class="p">,</span> <span class="n">yend</span> <span class="o">=</span> <span class="n">Ly</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mf">0.221</span><span class="p">,</span> <span class="n">Ly</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mf">0.221</span>
<span class="linenos">240</span>   <span class="n">zstart</span><span class="p">,</span> <span class="n">zend</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>  <span class="c1"># 1m above surface.</span>
<span class="linenos">241</span>
<span class="linenos">242</span>   <span class="c1"># Plane measurement settings</span>
<span class="linenos">243</span>   <span class="n">do_plane_measurements</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos">244</span>   <span class="n">plane_nnx</span><span class="p">,</span> <span class="n">plane_nny</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span>
<span class="linenos">245</span>   <span class="n">plane_x0</span><span class="p">,</span> <span class="n">plane_y0</span><span class="p">,</span> <span class="n">plane_z0</span> <span class="o">=</span> <span class="o">-</span><span class="n">Lx</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">Ly</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span>
<span class="linenos">246</span>   <span class="n">plane_Lx</span><span class="p">,</span> <span class="n">plane_Ly</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Lx</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Ly</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">u</span> <span class="n">MTE</span><span class="o">.</span><span class="n">py</span> <span class="o">|</span> <span class="n">tee</span> <span class="n">log</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p flanksim_parameters/south/ztr/250_250_5 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</li>
<li><p>Run extra setups &amp; move files (5)</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">223</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">224</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">10</span>
</span></pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">223</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">224</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">20</span>
</span></pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">223</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">224</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">40</span>
</span></pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">223</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">224</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">20</span>
</span></pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">223</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">224</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">20</span>
</span></pre></div>
</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong> (runtime: ~1 hr, ~1 hr, ~1 hr, ~4 hr, ~16 hr)</span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">u</span> <span class="n">MTE</span><span class="o">.</span><span class="n">py</span> <span class="o">|</span> <span class="n">tee</span> <span class="n">log</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</div>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p flanksim_parameters/south/ztr/250_250_10 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p flanksim_parameters/south/ztr/250_250_20 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p flanksim_parameters/south/ztr/250_250_40 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p flanksim_parameters/south/ztr/500_500_20 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p flanksim_parameters/south/ztr/1000_1000_20 &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p>Run three sloped zero topography setups &amp; move files</p>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">45</span><span class="n">benchmark</span> <span class="o">=</span> <span class="s1">&#39;5&#39;</span>
<span class="linenos">46</span>
<span class="linenos">47</span><span class="n">compute_vi</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Possible for all setups apart from DEM (-1).</span>
<span class="linenos">48</span><span class="k">if</span> <span class="n">compute_vi</span><span class="p">:</span>
<span class="linenos">49</span>   <span class="n">nqdim</span> <span class="o">=</span> <span class="mi">6</span>  <span class="c1"># Number of quadrature points, see documentation.</span>
<span class="linenos">50</span>
<span class="linenos">51</span><span class="c1">## ONLY BENCHMARK = -1 (DEM) &amp; BENCHMARK = 5 (FLANKSIM) ##</span>
<span class="linenos">52</span><span class="n">flat_bottom</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># If True, a flat bottom is generated at the lower surface of the domain.</span>
<span class="linenos">53</span>                    <span class="c1"># Please see documentation, as the specific setup of this feature is different</span>
<span class="linenos">54</span>                    <span class="c1"># for the flank simulations and the DEM test.</span>
<span class="hll"><span class="linenos">55</span><span class="n">remove_zerotopo</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Setup run 2 times: 1st time, zero topography setup: xy coordinates</span>
</span><span class="linenos">56</span>                        <span class="c1"># of the observation points the same, but zerotopo domain and obs path</span>
<span class="linenos">57</span>                        <span class="c1"># shifted to average height DEM. 2nd time, &quot;regular&quot; run with topography.</span>
<span class="linenos">58</span>                        <span class="c1"># final results are 2nd run - 1 st run values. Run time can be improved,</span>
<span class="linenos">59</span>                        <span class="c1"># if 1st run was done with less el (and cuboid function), yet to be done.</span>
<span class="linenos">60</span>
<span class="linenos">61</span><span class="c1">## ONLY BENCHMARK = 5 (FLANKSIM) ##</span>
<span class="linenos">62</span><span class="n">subbench</span> <span class="o">=</span> <span class="s1">&#39;south&#39;</span>  <span class="c1"># &#39;south&#39;, &#39;east&#39;, &#39;north&#39;, &#39;west&#39;, shifts topo features, and obs paths.</span>
</pre></div>
</div>
</div>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">223</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">224</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">10</span>
</span><span class="linenos">225</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">),</span> <span class="mi">10</span>
<span class="linenos">226</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
<span class="linenos">227</span><span class="c1">#Lx, Ly, Lz = 50, 50, 120</span>
<span class="linenos">228</span><span class="c1">#nelx, nely, nelz = 10, 10, 10</span>
<span class="linenos">229</span>
<span class="linenos">230</span><span class="c1"># Synthetic topography settings</span>
<span class="hll"><span class="linenos">231</span><span class="n">wavelength</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class="hll"><span class="linenos">232</span><span class="n">A</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class="linenos">233</span><span class="n">af</span> <span class="o">=</span> <span class="mi">6</span>
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">223</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">224</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">20</span>
</span><span class="linenos">225</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">),</span> <span class="mi">10</span>
<span class="linenos">226</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
<span class="linenos">227</span><span class="c1">#Lx, Ly, Lz = 50, 50, 120</span>
<span class="linenos">228</span><span class="c1">#nelx, nely, nelz = 10, 10, 10</span>
<span class="linenos">229</span>
<span class="linenos">230</span><span class="c1"># Synthetic topography settings</span>
<span class="linenos">231</span><span class="n">wavelength</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos">232</span><span class="n">A</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos">233</span><span class="n">af</span> <span class="o">=</span> <span class="mi">6</span>
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">223</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">224</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">40</span>
</span><span class="linenos">225</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">),</span> <span class="mi">10</span>
<span class="linenos">226</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
<span class="linenos">227</span><span class="c1">#Lx, Ly, Lz = 50, 50, 120</span>
<span class="linenos">228</span><span class="c1">#nelx, nely, nelz = 10, 10, 10</span>
<span class="linenos">229</span>
<span class="linenos">230</span><span class="c1"># Synthetic topography settings</span>
<span class="linenos">231</span><span class="n">wavelength</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos">232</span><span class="n">A</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos">233</span><span class="n">af</span> <span class="o">=</span> <span class="mi">6</span>
</pre></div>
</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong> (runtime: ~30 min, ~30 min, ~30 min)</span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">u</span> <span class="n">MTE</span><span class="o">.</span><span class="n">py</span> <span class="o">|</span> <span class="n">tee</span> <span class="n">log</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</div>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p flanksim_parameters/south/ztr/250_250_10_ss &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p flanksim_parameters/south/ztr/250_250_20_ss &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p flanksim_parameters/south/ztr/250_250_40_ss &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p>Go to directory &amp; plot to visualize</p>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">flanksim_parameters</span><span class="o">/</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/flanksim_parameters/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gnuplot</span> <span class="n">plot_script_ztr</span><span class="o">.</span><span class="n">p</span>
</pre></div>
</div>
</div>
</li>
</ol>
</details></section>
</section>
</section>
<section id="bottom-boundary">
<h2>Bottom boundary<a class="headerlink" href="#bottom-boundary" title="Link to this heading"></a></h2>
<div class="line-block">
<div class="line">One last issue to contemplate, is the shape of the bottom of the mesh. The topography on the bottom can be simulated in two ways:</div>
</div>
<ol class="arabic simple">
<li><p>use the same topography as the top surface at Lx below the topography.</p></li>
<li><p>produce a level plane at Lz below the lowest point of the topography.</p></li>
</ol>
<figure class="align-default" id="id26">
<span id="sb-fb"></span><a class="reference internal image-reference" href="_images/sb_fb_250_250_20.png"><img alt="_images/sb_fb_250_250_20.png" src="_images/sb_fb_250_250_20.png" style="width: 769.0px; height: 224.5px;" /></a>
<figcaption>
<p><span class="caption-number">Figure 18 </span><span class="caption-text">The resulting mesh using either the same topography as the top surface (on the right) or a flat bottom (on the left) for the setup as outlined in <a class="reference internal" href="flanksim.html#flanksim"><span class="std std-ref">flank simulations</span></a>.</span><a class="headerlink" href="#id26" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="line-block">
<div class="line">See <a class="reference internal" href="#sb-fb"><span class="std std-numref">Figure 18</span></a> for the visualization of the different options.</div>
</div>
<div class="line-block">
<div class="line">As our computational solution is a surface integral and the interior contributions should cancel out, we can understand the possible repercussion of this predicament. Neither is an accurate representation of reality and from theory we know the effect could be significant. Therefore, the differences need to be investigated and both methods will be used and compared.</div>
</div>
<section id="id13">
<h3>Model setup<a class="headerlink" href="#id13" title="Link to this heading"></a></h3>
<p>To compare the two methods, similar model setups as before are used. Again, testing incorporates the subtraction of a flat-terrain domain from the final results. Tests were done on domains with sizes of <span class="math notranslate nohighlight">\(250\times250\times10\)</span> and <span class="math notranslate nohighlight">\(250\times250\times20\)</span> meter, adhering previously establish tresholds for the amount of elements.</p>
</section>
<section id="id14">
<h3>Results<a class="headerlink" href="#id14" title="Link to this heading"></a></h3>
<figure class="align-default" id="id27">
<span id="topo-zt-fb-sb"></span><a class="reference internal image-reference" href="_images/topo_zt_fb_sb.png"><img alt="_images/topo_zt_fb_sb.png" src="_images/topo_zt_fb_sb.png" style="width: 1120.0px; height: 420.0px;" /></a>
<figcaption>
<p><span class="caption-number">Figure 19 </span><span class="caption-text">Three subplots depicting the components of the computed magnetic field <strong>B</strong> for the depth experiments. The numbers in the key relate to the length of each side of the domain (Lx_Ly_Lz). Please note, the y-axis varies between each subplot.</span><a class="headerlink" href="#id27" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>In <a class="reference internal" href="#topo-zt-fb-sb"><span class="std std-numref">Figure 19</span></a>, we observe that the solution of subtraction a zero topography method does not produce adequate results if the same topography is used at the bottom, which was to be expected, as in this setup the bottom surface for the zero topography domain and regular run are not identical.</p>
<section id="id15">
<h4>Reproduce<a class="headerlink" href="#id15" title="Link to this heading"></a></h4>
<details class="summary-how-to-reproduce-the-results-and-figures-for-synthetic-topography">
<summary>How to reproduce the results and figures for synthetic topography</summary><p>Please note basic setup in <a class="reference internal" href="usage.html#installation"><span class="std std-ref">Installation</span></a>.</p>
<ol class="arabic">
<li><p>In <code class="docutils literal notranslate"><span class="pre">MTE.py</span></code>, modify benchmark attribution to <code class="docutils literal notranslate"><span class="pre">5</span></code>, and make sure the right setup is used:</p>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="linenos">45</span><span class="n">benchmark</span> <span class="o">=</span> <span class="s1">&#39;5&#39;</span>
</span><span class="linenos">46</span>
<span class="linenos">47</span><span class="n">compute_vi</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Possible for all setups apart from DEM (-1).</span>
<span class="linenos">48</span><span class="k">if</span> <span class="n">compute_vi</span><span class="p">:</span>
<span class="linenos">49</span>   <span class="n">nqdim</span> <span class="o">=</span> <span class="mi">6</span>  <span class="c1"># Number of quadrature points, see documentation.</span>
<span class="linenos">50</span>
<span class="linenos">51</span><span class="c1">## ONLY BENCHMARK = -1 (DEM) &amp; BENCHMARK = 5 (FLANKSIM) ##</span>
<span class="hll"><span class="linenos">52</span><span class="n">flat_bottom</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># If True, a flat bottom is generated at the lower surface of the domain.</span>
</span><span class="linenos">53</span>                    <span class="c1"># Please see documentation, as the specific setup of this feature is different</span>
<span class="linenos">54</span>                    <span class="c1"># for the flank simulations and the DEM test.</span>
<span class="hll"><span class="linenos">55</span><span class="n">remove_zerotopo</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Setup run 2 times: 1st time, zero topography setup: xy coordinates</span>
</span><span class="linenos">56</span>                        <span class="c1"># of the observation points the same, but zerotopo domain and obs path</span>
<span class="linenos">57</span>                        <span class="c1"># shifted to average height DEM. 2nd time, &quot;regular&quot; run with topography.</span>
<span class="linenos">58</span>                        <span class="c1"># final results are 2nd run - 1 st run values. Run time can be improved,</span>
<span class="linenos">59</span>                        <span class="c1"># if 1st run was done with less el (and cuboid function), yet to be done.</span>
<span class="linenos">60</span>
<span class="linenos">61</span><span class="c1">## ONLY BENCHMARK = 5 (FLANKSIM) ##</span>
<span class="hll"><span class="linenos">62</span><span class="n">subbench</span> <span class="o">=</span> <span class="s1">&#39;south&#39;</span>  <span class="c1"># &#39;south&#39;, &#39;east&#39;, &#39;north&#39;, &#39;west&#39;, shifts topo features, and obs paths.</span>
</span></pre></div>
</div>
</div>
</li>
<li><p>Run two same bottom setups &amp; move files (not included lines same as before)</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">223</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">224</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">10</span>
</span><span class="linenos">225</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">),</span> <span class="mi">10</span>
<span class="linenos">226</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
<span class="linenos">227</span><span class="c1">#Lx, Ly, Lz = 50, 50, 120</span>
<span class="linenos">228</span><span class="c1">#nelx, nely, nelz = 10, 10, 10</span>
<span class="linenos">229</span>
<span class="linenos">230</span><span class="c1"># Synthetic topography settings</span>
<span class="hll"><span class="linenos">231</span><span class="n">wavelength</span> <span class="o">=</span> <span class="mi">25</span>
</span><span class="hll"><span class="linenos">232</span><span class="n">A</span> <span class="o">=</span> <span class="mi">6</span>
</span><span class="linenos">233</span><span class="n">af</span> <span class="o">=</span> <span class="mi">6</span>
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/MTE.py</strong></span></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">223</span><span class="c1"># Domain settings</span>
<span class="hll"><span class="linenos">224</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">20</span>
</span><span class="linenos">225</span><span class="n">nelx</span><span class="p">,</span> <span class="n">nely</span><span class="p">,</span> <span class="n">nelz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">),</span> <span class="mi">10</span>
<span class="linenos">226</span><span class="n">Mx0</span><span class="p">,</span> <span class="n">My0</span><span class="p">,</span> <span class="n">Mz0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.085</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.29</span>
<span class="linenos">227</span><span class="c1">#Lx, Ly, Lz = 50, 50, 120</span>
<span class="linenos">228</span><span class="c1">#nelx, nely, nelz = 10, 10, 10</span>
<span class="linenos">229</span>
<span class="linenos">230</span><span class="c1"># Synthetic topography settings</span>
<span class="linenos">231</span><span class="n">wavelength</span> <span class="o">=</span> <span class="mi">25</span>
<span class="linenos">232</span><span class="n">A</span> <span class="o">=</span> <span class="mi">6</span>
<span class="linenos">233</span><span class="n">af</span> <span class="o">=</span> <span class="mi">6</span>
</pre></div>
</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong>  (runtime: ~1 hr, ~1 hr)</span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">u</span> <span class="n">MTE</span><span class="o">.</span><span class="n">py</span> <span class="o">|</span> <span class="n">tee</span> <span class="n">log</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</div>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p flanksim_parameters/south/ztr/250_250_10_sb &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
<td><div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p flanksim_parameters/south/ztr/250_250_20_sb &amp;&amp; mv log.txt *.vtu *.ascii $_
</pre></div>
</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p>Go to directory &amp; plot to visualize</p>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">flanksim_parameters</span><span class="o">/</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container">
<div class="code-block-caption"><span class="caption-text"><strong>/main/flanksim_parameters/</strong></span></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gnuplot</span> <span class="n">plot_script_sb</span><span class="o">.</span><span class="n">p</span>
</pre></div>
</div>
</div>
</li>
</ol>
</details></section>
</section>
</section>
<section id="conclusions">
<h2>Conclusions<a class="headerlink" href="#conclusions" title="Link to this heading"></a></h2>
<div class="line-block">
<div class="line">The results from the parameter tests as desciribed above, allow for establishment of several tresholds for optimized model setups:</div>
</div>
<ol class="arabic simple">
<li><p>The amount of elements in the z-direction is irrelevant and will be maintained at ten.</p></li>
<li><p>The amount of elements in the xy-direction for synthetic topography should be at least 1.5 elements per meter (at a height of 1 meter above the surface).</p></li>
<li><p>The spatial extent of the domain needs to be at least 250x250 meter to avoid a significant edge effect on a central measurement path (of ~50 meter).</p></li>
<li><dl class="simple">
<dt>Extending the depth and spatial extent has a proportional impact on the magnitude of the <span class="math notranslate nohighlight">\(B_z\)</span> and <span class="math notranslate nohighlight">\(B_x\)</span> components.</dt><dd><ul class="simple">
<li><p>To remove the domain related variations, one can subtract the values computed over a flat topography domain from the observed results. We recommend implementing a flat boundary surface at a consistent depth beneath the lowest topographical point within the domain. The thickness of this “zero topography” domain should be calibrated to match that beneath the observation path within the topographic domain.</p></li>
</ul>
</dd>
</dl>
</li>
</ol>
<p class="rubric">Footnotes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id16" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">1</a><span class="fn-bracket">]</span></span>
<p>To avoid redundancy, in this section we outline one setup for each of tests done, if repeated tests are done with different setups, the rest of the model setups are located in side by side code snippets. To be able to fully reproduce the figures, all these setups are required.</p>
</aside>
</aside>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="benchmarks.html" class="btn btn-neutral float-left" title="Benchmarks" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="flanksim.html" class="btn btn-neutral float-right" title="Synthetic topopography: flank simulations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, A.E. Hendrickx.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
<style type="text/css">
  .scrollToTop {
    text-align: center;
    font-weight: bold;
    position: fixed;
    bottom: 60px;
    right: 40px;
    display: none;
  }
</style>
<a href="#" class="scrollToTop">Scroll To Top</a>
<script type="text/javascript">
  $(document).ready(function () {
    //Check to see if the window is top if not then display button
    $(window).scroll(function () {
      if ($(this).scrollTop() > 200) {
        $(".scrollToTop").fadeIn();
      } else {
        $(".scrollToTop").fadeOut();
      }
    });

    //Click event to scroll to top
    $(".scrollToTop").click(function () {
      $("html, body").animate(
        {
          scrollTop: 0,
        },
        500,
      );
      return false;
    });
  });
</script>

<style>
  /* Sidebar header (and topbar for mobile) */
  .wy-side-nav-search,
  .wy-nav-top {
    background: #3ae23a;
  }
  /* Sidebar */
  .wy-nav-side {
    background: #0c3303;
  }
</style>


</body>
</html>